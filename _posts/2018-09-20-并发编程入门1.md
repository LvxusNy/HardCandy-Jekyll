---
layout: post
title:  "并发编程入门-1"
date:   2018-9-20
tags: 并发编程
color: rgb(255,90,90)
cover: '../assets/concurrentprogram.jpg'
---

# 并发是指在处理器在同一时间片段内同时处理多个任务的能力

	1. 上下文切换
		* CPU通过时间片分配算法来循环任务，当前任务行一个时间片后会切换到下个任务。在切换之前会保存上一个任务的状态，以便切换回上一个任务时，可以再加载上一个任务的状态。因此，任务从保存到再加载的过程就是一次上下文切换
		**在累加操作数量小的时候，并发执行要比串行执行用时要长**
		**原因是并行执行多了启用线程和切换上下文的操作**

	2. 减少切换上下文的方法
		1. 无锁并发编程-->将数据的ID按照hash算法取模分段，不同线程处理不同段数据
		2. CAS算法-->使用juc 的 atomic包
		3. 使用最少线程-->避免创建不必要的线程
		4. 使用协程-->在单线程里进行多任务调度，并在单线程里维持多个任务的切换

	3. 死锁
		*获取锁的线程(?)在某种情况下并没有释放锁，一直占用，导致其他线程无法获取锁的情况

	4. 避免死锁的常见方法
		* 避免一个线程同时获得多个锁
		* 避免一个线程在锁内同时占用多个资源，尽量保证每个锁只占用一个资源
		* 尝试定时锁时，使用lock.tryLock(timeout)来代替内部锁机制
		* 对于数据库锁，加锁和解锁必须在同一个数据库里，否则会出现解锁失败